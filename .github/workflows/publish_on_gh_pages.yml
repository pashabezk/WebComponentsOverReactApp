name: Auto publish on GH Pages

# sets workflow auto run
on:
    push:
        branches: [ "main" ]
        paths: # action will run only if changes paths below
            - "src/**"
            - ".github/workflows/**"
    workflow_dispatch: # to allow run action via github interface

permissions:
    contents: read
    pages: write
    id-token: write

jobs:
    build_and_push: # job name
        runs-on: ubuntu-22.04

        steps:
            -   name: Checkout repository
                uses: actions/checkout@v4

            -   name: Use Node.js
                uses: actions/setup-node@v2
                with:
                    node-version: '22.20'

            -   name: Install Deps
                run: npm install

            -   name: Build
                run: npm run build

            -   name: Upload artifact
                uses: actions/upload-pages-artifact@v3
                with:
                    path: ./dist

            -   name: Deploy to GitHub Pages
                uses: actions/deploy-pages@v4
